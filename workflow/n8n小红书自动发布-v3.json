{
  "name": "å°çº¢ä¹¦ï½œçŸ©é˜µå·è‡ªåŠ¨å‘å¸ƒ",
  "nodes": [
    {
      "parameters": {
        "jsCode": "const raw = ($json.body?.chatInput || $json.chatInput || $json.query?.chatInput || \"\").trim();\n\n// 0ï¸âƒ£ å°è¯• URL è§£ç  (ä»…å½“æ£€æµ‹åˆ°ç¼–ç å­—ç¬¦æ—¶)\ntry {\n  if (/%[0-9a-fA-F]{2}/.test(raw)) {\n    const decoded = decodeURIComponent(raw);\n    if (decoded !== raw) {\n       console.log(\"Decoded input:\", decoded);\n       // åªæœ‰è§£ç æˆåŠŸæ‰è¦†ç›–ï¼Œé˜²æ­¢æ„å¤–\n       // (æ³¨æ„ï¼šè¿™é‡Œç›´æ¥ç”¨ decodeURIComponent åçš„å€¼é€šå¸¸æ˜¯æ²¡é—®é¢˜çš„)\n       // raw = decoded; \n       // ä¿®æ­£ï¼šdecodeURIComponent å¯¹ POST body é€šå¸¸ä¸éœ€è¦ï¼Œé™¤éæ˜¯ raw encoded\n       // ä½†ä¸ºäº†ä¸€è‡´æ€§ï¼Œå¦‚æœç”¨æˆ·è¯¯ä¼ äº† encoded ä¸²ä¹Ÿå¯è§£\n    }\n  }\n} catch (e) {}\n\nconsole.log(\"Final Input:\", raw);\n\nlet data = {};\n\n// 1ï¸âƒ£ å°è¯• JSON è§£æ\ntry {\n  const parsed = JSON.parse(raw);\n  if (typeof parsed === \"object\") {\n    data = parsed;\n  }\n} catch (e) {\n  // é JSONï¼Œç»§ç»­èµ°è‡ªç„¶è¯­è¨€è§£æ\n}\n\n// 2ï¸âƒ£ è‡ªç„¶è¯­è¨€è§£æå·¥å…·å‡½æ•°\nfunction pick(label) {\n  const reg = new RegExp(\n    `${label}\\\\s*[ï¼š:]\\s*([^ã€‚ï¼›;\\\\n]+)`,\n    \"i\"\n  );\n  const m = raw.match(reg);\n  return m ? m[1].trim() : \"\";\n}\n\n// 3ï¸âƒ£ topic / subject\nif (!data.topic && !data.subject) {\n  data.topic = pick(\"ä¸»é¢˜\") || pick(\"é€‰é¢˜\");\n}\nif (!data.topic) {\n  data.topic = raw.slice(0, 30);\n}\n\n// 4ï¸âƒ£ accounts\nif (!data.accounts) {\n  const accRaw = pick(\"è´¦å·\");\n  if (accRaw) {\n    data.accounts = accRaw\n      .replace(/ï¼Œ/g, \",\")\n      .split(\",\")\n      .map(s => s.trim())\n      .filter(Boolean);\n  } else {\n    data.accounts = [\"ä½ çš„æ•ˆç‡é—ºèœœ\"];\n  }\n}\n\n// 5ï¸âƒ£ word_count\nif (!data.word_count) {\n  const wcMatch = raw.match(/(\\d{2,4})\\s*å­—/);\n  data.word_count = wcMatch ? Number(wcMatch[1]) : 600;\n}\n\n// 6ï¸âƒ£ context\nif (!data.context) {\n  data.context = pick(\"èƒŒæ™¯\") || pick(\"è¯´æ˜\") || \"\";\n}\n\n// 7ï¸âƒ£ è¾“å‡ºç»Ÿä¸€ç»“æ„\nreturn [\n  {\n    subject: data.topic,\n    accounts: data.accounts,\n    word_count: data.word_count,\n    context: data.context\n  }\n];\n"
      },
      "id": "58c912a5-1719-4eff-a2d4-fdcc7b90a1a6",
      "name": "è¾“å…¥è§„èŒƒåŒ–",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1392,
        -224
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ä½ æ˜¯ä¸€ä½èµ„æ·±çš„å°çº¢ä¹¦å†…å®¹åˆ›ä½œä¸“å®¶ã€‚\n\nã€ä½ çš„ä»»åŠ¡ã€‘\næ ¹æ®ç”¨æˆ·çš„å†…å®¹éœ€æ±‚ï¼Œ**ä¸¥æ ¼å¡«å……ä¸‹é¢çš„ JSON ç»“æ„**ï¼Œä¸å¾—è¾“å‡ºä»»ä½•å¤šä½™æ–‡å­—ã€‚\n\n====================\nã€è¾“å…¥ä¿¡æ¯ã€‘\nç”¨æˆ·éœ€æ±‚ï¼š\nä¸»é¢˜ï¼š{{ $json.subject }}\nå­—æ•°ï¼š{{ $json.word_count }}\nèƒŒæ™¯ï¼š{{ $json.context }}\n\n====================\nã€æ ‡é¢˜åˆ›ä½œæŠ€å·§ï¼ˆè¯·å‚ç…§ä»¥ä¸‹è§„åˆ™ï¼‰ã€‘ï¼š\n\n1. é‡‡ç”¨äºŒæç®¡æ ‡é¢˜æ³•è¿›è¡Œåˆ›ä½œï¼š\n   1.1 åŸºæœ¬åŸç†ï¼šæœ¬èƒ½å–œæ¬¢æœ€çœåŠ›æ³•åˆ™å’ŒåŠæ—¶äº«å—ï¼›åŠ¨ç‰©åŸºæœ¬é©±åŠ¨åŠ›æ˜¯è¿½æ±‚å¿«ä¹å’Œé€ƒé¿ç—›è‹¦ï¼Œç”±æ­¤è¡ç”Ÿå‡º2ä¸ªåˆºæ¿€ï¼šæ­£åˆºæ¿€ã€è´Ÿåˆºæ¿€ã€‚\n   1.2 æ ‡é¢˜å…¬å¼ï¼š\n      - æ­£é¢åˆºæ¿€ï¼šäº§å“æˆ–æ–¹æ³•+åªéœ€1ç§’ï¼ˆçŸ­æœŸï¼‰+ä¾¿å¯å¼€æŒ‚ï¼ˆé€†å¤©æ•ˆæœï¼‰\n      - è´Ÿé¢åˆºæ¿€ï¼šä½ ä¸X+ç»å¯¹ä¼šåæ‚”ï¼ˆå¤©å¤§æŸå¤±ï¼‰+ï¼ˆç´§è¿«æ„Ÿï¼‰\n      ï¼ˆåˆ©ç”¨äººä»¬åŒæ¶æŸå¤±å’Œè´Ÿé¢åè¯¯çš„å¿ƒç†ï¼Œä½¿äººä»¬åœ¨é¢å¯¹è´Ÿé¢æ¶ˆæ¯æ—¶æ›´åŠ æ•æ„Ÿï¼‰\n\n2. ä½¿ç”¨å…·æœ‰å¸å¼•åŠ›çš„æ ‡é¢˜ï¼š\n   2.1 ä½¿ç”¨æ ‡ç‚¹ç¬¦å·ï¼Œåˆ›é€ ç´§è¿«æ„Ÿå’ŒæƒŠå–œæ„Ÿ (å¦‚ï¼šï¼ã€ï¼Ÿã€â€¦ç­‰)\n   2.2 é‡‡ç”¨å…·æœ‰æŒ‘æˆ˜æ€§å’Œæ‚¬å¿µçš„è¡¨è¿°\n   2.3 åˆ©ç”¨æ­£é¢åˆºæ¿€å’Œè´Ÿé¢åˆºæ¿€\n   2.4 èå…¥çƒ­ç‚¹è¯é¢˜å’Œå®ç”¨å·¥å…·\n   2.5 æè¿°å…·ä½“çš„æˆæœå’Œæ•ˆæœ\n   2.6 ä½¿ç”¨emojiè¡¨æƒ…ç¬¦å·ï¼Œå¢åŠ æ ‡é¢˜çš„æ´»åŠ›\n\n3. ä»å°çº¢ä¹¦æœç´¢çˆ†æ¬¾å…³é”®è¯top100,å¹¶é€‰æ‹©1-2ä¸ªä½¿ç”¨\n\n4. æ§åˆ¶å­—æ•°åœ¨20å­—ä»¥å†…ï¼Œæ–‡æœ¬å°½é‡ç®€çŸ­ï¼Œä»¥å£è¯­åŒ–çš„è¡¨è¾¾æ–¹å¼ï¼Œæ‹‰è¿‘ä¸è¯»è€…çš„è·ç¦»\n\n5.åªå®Œæˆã€æ ‡é¢˜ä¸å¤§çº²ã€‘ï¼š\n  5.1 ç”Ÿæˆ5ä¸ªæ ‡é¢˜ï¼ˆ<20å­—ï¼ŒäºŒæç®¡æ ‡é¢˜æ³•ï¼‰\n  5.2 ç»™å‡ºæœ€ç»ˆæ ‡é¢˜ï¼Œå­—æ•°å°äº20å­—\n  5.3 è¾“å‡ºæ­£æ–‡å¤§çº²\n  5.4 ç»™å‡º5ä¸ªæ ‡ç­¾\n\n6.ç”Ÿæˆçš„å†…å®¹ç”¨ä¸­æ–‡ï¼Œå¯ä»¥æœ‰ä¸€äº›ä¸“ä¸šè‹±æ–‡åè¯ï¼Œä½†ä¸èƒ½å…¨æ˜¯è‹±æ–‡ã€‚\n\n====================\n**è¾“å‡ºæ ¼å¼å¿…é¡»åªè¾“å‡ºä¸‹é¢ JSONï¼Œä¸å¾—æ·»åŠ è§£é‡Šã€æ³¨é‡Šã€markdownã€æ¢è¡Œè¯´æ˜**\n{\n  \"titles\": [],\n  \"final_title\": \"\",\n  \"content_outline\": [],\n  \"tags\": [],\n  \"subject\": \"\",\n  \"context\": \"\",\n  \"word_count\": 0\n}",
        "hasOutputParser": true
      },
      "id": "f8db4dc8-9de6-4e3a-8e02-03cdaa9f07ad",
      "name": "é€‰é¢˜ç»“æ„ç”Ÿæˆ",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.6,
      "position": [
        -1264,
        -32
      ]
    },
    {
      "parameters": {
        "jsCode": "// æ¸…ç†å¹¶è§£æ JSON è¾“å‡º\nconst raw = $json.response || $json.output || $json.text || '';\n\n// ç§»é™¤å¯èƒ½çš„ markdown ä»£ç å—æ ‡è®°\nlet cleaned = String(raw)\n  .replace(/^```json\\s*/i, '')\n  .replace(/^```\\s*/i, '')\n  .replace(/```\\s*$/i, '')\n  .trim();\n\n// è§£æ JSON\ntry {\n  const parsed = JSON.parse(cleaned);\n  return [{ json: parsed }];\n} catch (e) {\n  // å¦‚æœè§£æå¤±è´¥ï¼Œå°è¯•æå– JSON éƒ¨åˆ†\n  const match = cleaned.match(/\\{[\\s\\S]*\\}/);\n  if (match) {\n    try {\n      const parsed = JSON.parse(match[0]);\n      return [{ json: parsed }];\n    } catch (e2) {\n      throw new Error('JSON è§£æå¤±è´¥: ' + e2.message + '\\nåŸå§‹å†…å®¹: ' + raw);\n    }\n  }\n  throw new Error('æ— æ³•æ‰¾åˆ°æœ‰æ•ˆçš„ JSON å†…å®¹\\nåŸå§‹å†…å®¹: ' + raw);\n}"
      },
      "id": "a970b234-c4b0-4c79-acc0-0ed521643fcd",
      "name": "JSONè§£æå™¨",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -928,
        -272
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ä½ æ˜¯ä¸€ä½èµ„æ·±çš„å°çº¢ä¹¦å†…å®¹åˆ›ä½œä¸“å®¶ï¼Œå°†æ ¹æ®ç”¨æˆ·çš„å†…å®¹éœ€æ±‚ï¼Œå¾ªä»¥ä¸‹è§„åˆ™æ‰§è¡Œä»»åŠ¡ã€‚\nç”¨æˆ·éœ€æ±‚ï¼š\næ ‡é¢˜ï¼š{{ $json.final_title}}\nä¸»é¢˜ï¼š{{$json.subject}}\nå¤§çº²ï¼š{{$json.content_outline}}\nèƒŒæ™¯ï¼š{{$json.context}}\n\n## æ­£æ–‡åˆ›ä½œè§„åˆ™ï¼š\n*æ³¨æ„ï¼šä½ ä¸éœ€è¦ç”¨åˆ°èƒŒæ™¯ä¿¡æ¯ä¸­çš„å…¨éƒ¨å†…å®¹ï¼Œåªéœ€è¦åˆ©ç”¨å¥½èƒ½å¤ŸæœåŠ¡å†™ä½œä¸»é¢˜çš„å†…å®¹ã€‚é¦–å…ˆæ€è€ƒå“ªéƒ¨åˆ†å†…å®¹å¯¹äºå†™ä½œä¸»é¢˜æ˜¯æœ‰å¸®åŠ©çš„ï¼Œå†è¾“å‡ºæ–‡æ¡ˆ*\n1. é£æ ¼åŒ¹é…ï¼šä»ä¸»é¢˜{{$json.subject}}ã€æ­£æ–‡{{$json.content_outline}}æ˜ç¡®èµ›é“ã€å—ä¼—ã€å–ç‚¹åŠé£æ ¼åå¥½ï¼ŒåŒ¹é…å¯¹åº”é£æ ¼ï¼ˆç”Ÿæ´»ç±»â†’è½»æ¾/äº²åˆ‡/æ„‰å¿«ï¼›èŒåœºå¹²è´§ç±»â†’ä¸¥è‚ƒ/çœŸè¯š/å»ºè®®ï¼›æƒ…æ„Ÿæˆé•¿ç±»â†’æ¸©é¦¨/æ²‰æ€/é¼“åŠ±ï¼›æ´»åŠ¨ä¿ƒé”€ç±»â†’æ¿€åŠ¨/çƒ­æƒ…/æ¬¢ä¹ï¼‰ã€‚å¼€ç¯‡é’©å­éœ€ä¸ºä¸å—ä¼—å¼ºç›¸å…³çš„é«˜é¢‘ç—›ç‚¹é—®é¢˜æˆ–è¿‘æœŸå¹³å°çƒ­è®®çš„äº‰è®®è¯é¢˜ï¼Œéœ€èƒ½ç²¾å‡†å‡»ä¸­å—ä¼—éœ€æ±‚ï¼Œç¡®ä¿å¼€ç¯‡3ç§’å†…æŠ“ä½å—ä¼—æ³¨æ„åŠ›ã€‚\n2. å†…å®¹è¦æ±‚ï¼šéœ€èå…¥ç”±å®˜æ–¹æä¾›çš„å°çº¢ä¹¦è¿‘30å¤©æœç´¢é‡top500ä¸”ä¸ä¸»é¢˜é«˜åº¦ç›¸å…³çš„çƒ­é—¨å…³é”®è¯åŒ…ä¸­çš„å†…å®¹ï¼Œç»“å°¾è®¾äº’åŠ¨ï¼ˆå¼€æ”¾å¼é—®é¢˜/æŠ•ç¥¨/æ™’å›¾ï¼‰ï¼Œç»“æ„æ¸…æ™°ï¼ˆå¸ç›æ ‡é¢˜ã€ç—›ç‚¹å¼•å…¥ã€æ ¸å¿ƒå†…å®¹ã€äº’åŠ¨å¼•å¯¼ï¼‰ï¼Œå£è¯­åŒ–è¡¨è¾¾ï¼Œå­—æ•°50â€“{{ $json.word_count }}å­—ã€‚\n3. ä¸¥æ ¼å›´ç»•å¤§çº²{{$json.content_outline}}åˆ›ä½œï¼ŒèƒŒæ™¯ä¿¡æ¯é™å®šä¸ºä¸ä¸»é¢˜{{$json.subject}}ç›´æ¥ç›¸å…³çš„è¡Œä¸šæ•°æ®ã€ç”¨æˆ·æ™®éè®¤çŸ¥äº‹å®ï¼Œä»…åœ¨è¡¥å……è¯´æ˜æ ¸å¿ƒå†…å®¹æ—¶æŒ‰éœ€é€‰ç”¨ï¼Œä¸å¾—å¼•å…¥æ— å…³ä¿¡æ¯ã€‚\n4. æä¾›å›¾ç‰‡æ­é…å»ºè®®ï¼šæ ¹æ®æ–‡æ¡ˆä¸»é¢˜ç»™å‡ºå›¾ç‰‡é£æ ¼ï¼ˆå¦‚æ¸…æ–°/å¤å¤/ç§‘æŠ€æ„Ÿï¼‰ã€æ„å›¾æŠ€å·§ï¼ˆå¯¹è§’çº¿/å¯¹ç§°/ç‰¹å†™ï¼‰ã€è‰²å½©æ­é…åŠå¿…å¤‡å…ƒç´ ï¼ˆäº§å“å›¾/åœºæ™¯å›¾/å¯¹æ¯”å›¾ï¼‰çš„å…·ä½“å»ºè®®ï¼Œä¸è¦å‡ºç°emojiç­‰ç‰¹æ®Šå­—ç¬¦ï¼Œä¿æŒæ¸…çˆ½ï¼Œç›´æ¥ç»™å‡ºé£æ ¼ï¼Œä¸è¦å‡ºç°\"å°çº¢ä¹¦å°é¢\"è¿™ç§æç¤ºã€‚\n\nè¾“å‡º Markdownï¼š\n## æ ‡é¢˜\n{{$json.final_title}}\n\n## æ­£æ–‡\nï¼ˆæ­£æ–‡ï¼‰\n## å›¾ç‰‡å»ºè®®\nï¼ˆå›¾ç‰‡å»ºè®®ï¼‰\n\n## æ ‡ç­¾\n{{$json.tags.join(\" \")}}"
      },
      "id": "f0d73484-2d09-440f-acf1-e95bebb1599e",
      "name": "æ­£æ–‡ç”Ÿæˆ",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.6,
      "position": [
        -784,
        -16
      ]
    },
    {
      "parameters": {
        "jsCode": "const raw = $input.first().json.output || $input.first().json.text;\nconst title = raw.match(/## æ ‡é¢˜([\\s\\S]*?)## æ­£æ–‡/)?.[1]?.trim() || \"\";\nconst content = raw.match(/## æ­£æ–‡([\\s\\S]*?)## å›¾ç‰‡å»ºè®®/)?.[1]?.trim() || \"\";\nconst images = raw.match(/## å›¾ç‰‡å»ºè®®([\\s\\S]*?)## æ ‡ç­¾/)?.[1]?.trim() || \"\";\nconst tags = raw.match(/## æ ‡ç­¾([\\s\\S]*)$/)?.[1]?.trim().split(/\\s+/) || [];\n\nreturn [{ title, content, tags, images }];"
      },
      "id": "e1c062f9-fbc1-4803-b15d-06a4a42df252",
      "name": "æ­£æ–‡ç»“æ„æ‹†åˆ†",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -544,
        -256
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ä½ æ˜¯å°çº¢ä¹¦é…å›¾ä¸“å®¶ï¼Œæ“…é•¿æŠŠã€æ–‡ç« è§‚ç‚¹ã€‘è½¬åŒ–ä¸ºã€å¯¹åº”ç”»é¢ã€‘ã€‚\n\næ ‡é¢˜ï¼š{{$json.title}}\n\næ­£æ–‡æ‘˜è¦ï¼š\n{{$json.content}}\n\nè¯·ä¸¥æ ¼æŒ‰ä»¥ä¸‹æ­¥éª¤æ€è€ƒï¼Œä½†ã€ä¸è¦è¾“å‡ºæ€è€ƒè¿‡ç¨‹ã€‘ï¼š\n\næ­¥éª¤1ï¼šä»æ­£æ–‡ä¸­æç‚¼ 2â€“3 ä¸ªã€æ˜ç¡®ã€å¯è¢«ç”»é¢è¡¨è¾¾çš„æ ¸å¿ƒè§‚ç‚¹ã€‘\næ­¥éª¤2ï¼šä¸ºæ¯ä¸ªè§‚ç‚¹ç”Ÿæˆä¸€æ¡ã€å†…å®¹å›¾ Promptã€‘ï¼Œç´§æ‰£æ ‡é¢˜å’Œæ­£æ–‡çš„è§‚ç‚¹\næ­¥éª¤3ï¼šç”Ÿæˆ 1 æ¡ã€å°é¢å›¾ Promptã€‘ï¼Œç´§æ‰£æ ‡é¢˜è¦è¡¨è¾¾çš„è§‚ç‚¹\n\nç”Ÿæˆè§„åˆ™ï¼š\n1.{{$json.images}}\n2.ä¸è¦å‡ºç°emojiç­‰ç‰¹æ®Šå­—ç¬¦\n3.ä¸è¦ç”Ÿæˆå¹³å°logoï¼Œæ°´å°\n\n\nåªè¾“å‡ºä¸¥æ ¼ JSONï¼Œä¸è¦è§£é‡Šï¼š\n\n{\n  \"cover_image\": \"\",\n  \"content_images\": [],\n  \"content_images_count\": 0\n}",
        "hasOutputParser": true
      },
      "id": "63d35b0c-d4fa-417f-88ed-97905c9436f7",
      "name": "é…å›¾Promptç”Ÿæˆ",
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.6,
      "position": [
        -400,
        -32
      ]
    },
    {
      "parameters": {
        "jsCode": "// æ¸…ç†å¹¶è§£æé…å›¾ JSON è¾“å‡º\nconst raw = $json.response || $json.output || $json.text || '';\n\n// ç§»é™¤å¯èƒ½çš„ markdown ä»£ç å—æ ‡è®°\nlet cleaned = String(raw)\n  .replace(/^```json\\s*/i, '')\n  .replace(/^```\\s*/i, '')\n  .replace(/```\\s*$/i, '')\n  .trim();\n\n// è§£æ JSON\ntry {\n  const parsed = JSON.parse(cleaned);\n  return [{ json: parsed }];\n} catch (e) {\n  // å¦‚æœè§£æå¤±è´¥ï¼Œå°è¯•æå– JSON éƒ¨åˆ†\n  const match = cleaned.match(/\\{[\\s\\S]*\\}/);\n  if (match) {\n    try {\n      const parsed = JSON.parse(match[0]);\n      return [{ json: parsed }];\n    } catch (e2) {\n      throw new Error('é…å›¾JSONè§£æå¤±è´¥: ' + e2.message + '\\nåŸå§‹å†…å®¹: ' + raw);\n    }\n  }\n  throw new Error('æ— æ³•æ‰¾åˆ°æœ‰æ•ˆçš„é…å›¾JSONå†…å®¹\\nåŸå§‹å†…å®¹: ' + raw);\n}"
      },
      "id": "b05a69d9-ef9b-47a8-b171-5c45267ff718",
      "name": "é…å›¾JSONè§£æå™¨",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -144,
        -176
      ]
    },
    {
      "parameters": {
        "functionCode": "return $json.accounts.map(account => ({\n  account,\n  title: $json.title,\n  content: $json.content,\n  tags: $json.tags,\n  cover_image: $json.cover_image,\n  content_images: $json.content_images\n}));"
      },
      "id": "027cd630-15e7-4d9b-9d5c-4504f2755037",
      "name": "çŸ©é˜µè´¦å·æ‹†åˆ†",
      "type": "n8n-nodes-base.function",
      "typeVersion": 1,
      "position": [
        944,
        -688
      ]
    },
    {
      "parameters": {
        "text": "=è´¦å·ï¼š{{ $('è¾“å…¥è§„èŒƒåŒ–').item.json.accounts }}\n\nåŸå§‹æ­£æ–‡ï¼š\n{{ $('æ­£æ–‡ç»“æ„æ‹†åˆ†').item.json.content }}\n\nè¯·åœ¨ä¸æ”¹å˜ç»“æ„çš„å‰æä¸‹åšå·®å¼‚åŒ–æ”¹å†™ï¼Œåªè¾“å‡ºæ­£æ–‡å†…å®¹ã€‚",
        "options": {}
      },
      "id": "ee3ab763-4260-4c6a-9bb7-508d6871a515",
      "name": "çŸ©é˜µå·®å¼‚åŒ–æ”¹å†™Agent",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1,
      "position": [
        1152,
        -752
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://ark.cn-beijing.volces.com/api/v3/images/generations",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"model\": \"doubao-seedream-4-5-251128\",\n    \"prompt\": \"{{ $json.cover_image }}\\n\\nç”Ÿæˆè¦æ±‚ï¼ˆå¿…é¡»ä¸¥æ ¼éµå®ˆï¼‰ï¼š\\n- ä¸å‡ºç°ä¹±ç ã€ä¸å‡ºç°å‡å­—\\n- æ— ä»»ä½•å¹³å°æ ‡è¯†ã€æ— è§’æ ‡ã€æ— æ°´å°ã€æ— Logo\\n- å……æ»¡ç§‘æŠ€è´¨æ„Ÿï¼Œæµ…è‰²é£æ ¼\\n- ä½¿ç”¨æ¸…æ™°ã€å…·ä½“ã€å¯è¢«ç”»é¢è¡¨è¾¾çš„æè¿°\",\n    \"response_format\": \"url\",\n    \"size\": \"1728x2304\",\n    \"watermark\": false\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        64,
        -160
      ],
      "id": "367d3b8e-b697-422e-9597-a8d88bfd1319",
      "name": "ç”Ÿæˆå°é¢å›¾",
      "credentials": {
        "httpBearerAuth": {
          "id": "LbEnP8EQIlTtjOR6",
          "name": "ç«å±±-ç”Ÿå›¾-Bearer Auth"
        }
      }
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://ark.cn-beijing.volces.com/api/v3/images/generations",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpBearerAuth",
        "sendBody": true,
        "specifyBody": "json",
        "jsonBody": "={\n    \"model\": \"doubao-seedream-4-5-251128\",\n    \"prompt\": \"{{ $json.content_images }}\\n\\nç”Ÿæˆ{{ $json.content_images_count }}å¼ \\n\\nç”Ÿæˆè¦æ±‚ï¼ˆå¿…é¡»ä¸¥æ ¼éµå®ˆï¼‰ï¼š\\n- å›¾ç‰‡ä¸­ä¸å‡ºç°ä¹±ç ã€å‡å­—ã€ä¸å¯è¯†åˆ«å­—ç¬¦ç­‰é”™è¯¯å†…å®¹\\n- å›¾ç‰‡ä¸­æ— ä»»ä½•å¹³å°æ ‡è¯†ã€è§’æ ‡ã€æ°´å°ã€Logoç­‰å…ƒç´ \\n- æ•´ä½“é£æ ¼å¿…é¡»ä¸ºå……æ»¡ç§‘æŠ€è´¨æ„Ÿçš„æµ…è‰²é£æ ¼\\n- æ‰€æœ‰æè¿°å¿…é¡»è½¬åŒ–ä¸ºæ¸…æ™°ã€å…·ä½“ã€å¯è§†è§‰åŒ–çš„ç”»é¢å†…å®¹\\n- ä½¿ç”¨è§†è§‰éšå–»ï¼ˆå›¾æ ‡ã€æ„å›¾ã€è‰²å½©ï¼‰ä»£æ›¿æ–‡å­—\",\n    \"sequential_image_generation\": \"auto\",\n    \"sequential_image_generation_options\": {\"max_images\":4},\n    \"response_format\": \"url\",\n    \"size\": \"1728x2304\",\n    \"watermark\": false\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.3,
      "position": [
        64,
        64
      ],
      "id": "c8851d32-6ec4-461d-b65a-08649c3954ac",
      "name": "å†…å®¹å›¾ç”Ÿæˆ",
      "credentials": {
        "httpBearerAuth": {
          "id": "LbEnP8EQIlTtjOR6",
          "name": "ç«å±±-ç”Ÿå›¾-Bearer Auth"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "doubao-seed-1-6-251015",
          "mode": "list",
          "cachedResultName": "doubao-seed-1-6-251015"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        1120,
        -432
      ],
      "id": "3fdbaec2-2a77-4914-9bf8-be9134411402",
      "name": "ç«å±±-doubao",
      "credentials": {
        "openAiApi": {
          "id": "3iRvcAcvDVdKLy4T",
          "name": "ç«å±±å¼•æ“-æ–‡æœ¬"
        }
      }
    },
    {
      "parameters": {
        "endpointUrl": "http://47.109.91.65:18060/mcp",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.mcpClientTool",
      "typeVersion": 1.2,
      "position": [
        1264,
        -432
      ],
      "id": "9ade8a5f-5b77-4667-89b2-69309ad9569d",
      "name": "MCP Client"
    },
    {
      "parameters": {
        "numberInputs": 3
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        400,
        -48
      ],
      "id": "09f78a5b-859a-4cd5-a690-86e7eecbed3e",
      "name": "Merge"
    },
    {
      "parameters": {
        "jsCode": "const allItems = $input.all();\n\nconst textItem = allItems[0]?.json || {};\nconst coverItem = allItems[1]?.json || {};\nconst contentImageItem = allItems[2]?.json || {};\n\nconst title = textItem.title || \"\";\nconst content = textItem.content || \"\";\n\n// ===== æ ‡ç­¾è§„èŒƒåŒ–ï¼ˆé‡ç‚¹ï¼‰=====\nlet tagsRaw = textItem.tags || [];\nlet tags = [];\n\n// æƒ…å†µ 1ï¼štags æ˜¯å­—ç¬¦ä¸² \"#a,#b\"\nif (typeof tagsRaw === \"string\") {\n  tags = tagsRaw\n    .split(\",\")\n    .map(t => t.trim())\n    .filter(Boolean);\n}\n\n// æƒ…å†µ 2ï¼štags æ˜¯æ•°ç»„ [\"a\", \"#b\"]\nif (Array.isArray(tagsRaw)) {\n  tags = tagsRaw.map(t => String(t).trim()).filter(Boolean);\n}\n\n// ç»Ÿä¸€è¡¥ #\ntags = tags.map(t => (t.startsWith(\"#\") ? t : `#${t}`));\n\n// ===== å›¾ç‰‡åˆå¹¶ =====\nconst images = [\n  coverItem?.data?.[0]?.url,\n  ...(contentImageItem?.data || []).map(i => i.url)\n].filter(Boolean);\n\n// ===== è¾“å‡º =====\nreturn [\n  {\n    json: {\n      title,\n      content,\n      tags,              // æ•°ç»„å½¢å¼ï¼ˆæ¨èï¼‰\n      images\n    }\n  }\n];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        640,
        -16
      ],
      "id": "0f58a93e-f843-4605-88e5-638f6adf9b0c",
      "name": "ç»„è£…æ–‡æ¡ˆ"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "6982e63d-f2c9-4135-b90c-bb561b94462f",
              "name": "title",
              "value": "={{ $json.title }}",
              "type": "string"
            },
            {
              "id": "473348dd-ad42-442a-84ec-af7ea9d34399",
              "name": "content",
              "value": "={{ $json.content }}",
              "type": "string"
            },
            {
              "id": "132bcd83-70a5-4d87-ad81-5d3282363a2d",
              "name": "tags",
              "value": "={{ $json.tags }}",
              "type": "array"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        64,
        -384
      ],
      "id": "c4c64520-afb8-443d-a561-04c39d040875",
      "name": "Edit Fields"
    },
    {
      "parameters": {
        "endpointUrl": "http://47.109.91.65:18060/mcp",
        "tool": {
          "__rl": true,
          "value": "publish_content",
          "mode": "list",
          "cachedResultName": "publish_content"
        },
        "parameters": {
          "mappingMode": "defineBelow",
          "value": {
            "images": "={{ $('âœ…ç¡®è®¤å‘å¸ƒ').first().json.images }}",
            "content": "={{ $('âœ…ç¡®è®¤å‘å¸ƒ').first().json.content }}",
            "title": "={{ $('âœ…ç¡®è®¤å‘å¸ƒ').first().json.title }}",
            "tags": "={{ $('âœ…ç¡®è®¤å‘å¸ƒ').first().json.tags }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "content",
              "displayName": "content",
              "defaultMatch": false,
              "required": true,
              "display": true,
              "type": "string",
              "removed": false
            },
            {
              "id": "images",
              "displayName": "images",
              "defaultMatch": false,
              "required": true,
              "display": true,
              "type": "array",
              "defaultValue": "[\n  \"string\"\n]",
              "removed": false
            },
            {
              "id": "tags",
              "displayName": "tags",
              "defaultMatch": false,
              "required": false,
              "display": true,
              "type": "array",
              "defaultValue": "[\n  \"string\"\n]",
              "removed": false
            },
            {
              "id": "title",
              "displayName": "title",
              "defaultMatch": false,
              "required": true,
              "display": true,
              "type": "string",
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {
          "convertToBinary": true
        }
      },
      "type": "@n8n/n8n-nodes-langchain.mcpClient",
      "typeVersion": 1,
      "position": [
        1808,
        -16
      ],
      "id": "0594a013-da10-46f3-9b2a-76eb79f56234",
      "name": "xhs_mcp"
    },
    {
      "parameters": {
        "operation": "upsert",
        "dataTableId": {
          "__rl": true,
          "value": "hqQlHmeYfivx3ByD",
          "mode": "list",
          "cachedResultName": "notes",
          "cachedResultUrl": "/projects/ldZnw1KjOTfKmBAE/datatables/hqQlHmeYfivx3ByD"
        },
        "filters": {
          "conditions": [
            {
              "keyName": "=title",
              "keyValue": "={{ $('âœ…ç¡®è®¤å‘å¸ƒ').first().json.title }}"
            }
          ]
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "title": "={{ $('âœ…ç¡®è®¤å‘å¸ƒ').first().json.title }}",
            "content": "={{ $('âœ…ç¡®è®¤å‘å¸ƒ').first().json.content }}",
            "tags": "={{ $('âœ…ç¡®è®¤å‘å¸ƒ').first().json.tags.join(\",\") }}",
            "images": "={{ $('âœ…ç¡®è®¤å‘å¸ƒ').first().json.images.join(\",\") }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "title",
              "displayName": "title",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "content",
              "displayName": "content",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "tags",
              "displayName": "tags",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "images",
              "displayName": "images",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTable",
      "typeVersion": 1.1,
      "position": [
        1696,
        176
      ],
      "id": "fb3224fe-6996-49de-b294-04877fd75d0c",
      "name": "Upsert row(s)"
    },
    {
      "parameters": {
        "jsCode": "const data = $input.first().json;\n\n// æ„é€ å›¾ç‰‡ HTML\nconst imagesHtml = data.images\n  .map(url => `<img src=\"${url}\" class=\"slide-img\" />`)\n  .join('');\n  \n// æ„é€ æ ‡ç­¾ HTML\nconst tagsHtml = Array.isArray(data.tags) ? data.tags.join(' ') : data.tags;\n\n// ä¼˜å…ˆä½¿ç”¨ n8n æ³¨å…¥çš„å®˜æ–¹ Resume URL\nconst n8nResumeUrl = $execution.resumeUrl || '';\n\n// æ„é€ å®Œæ•´ HTML é¡µé¢\nconst html = `<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>å°çº¢ä¹¦å‘å¸ƒé¢„è§ˆ</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n\n  <style>\n    body {\n      margin: 0;\n      padding: 20px;\n      background: #f6f6f6;\n      font-family: -apple-system, BlinkMacSystemFont, \"PingFang SC\", Arial;\n    }\n\n    .card {\n      max-width: 420px;\n      margin: 0 auto;\n      background: #fff;\n      border-radius: 14px;\n      overflow: hidden;\n      box-shadow: 0 10px 28px rgba(0,0,0,0.08);\n    }\n\n    /* Carousel Container */\n    .carousel-wrapper {\n      position: relative;\n      background: #000;\n    }\n\n    .images {\n      display: flex;\n      overflow-x: auto;\n      scroll-snap-type: x mandatory;\n      -webkit-overflow-scrolling: touch;\n      scrollbar-width: none; /* Firefox */\n      scroll-behavior: smooth;\n    }\n    .images::-webkit-scrollbar {\n      display: none; /* Chrome/Safari */\n    }\n\n    .images img {\n      width: 100%;\n      height: auto;\n      flex-shrink: 0;\n      scroll-snap-align: center;\n      aspect-ratio: 3/4;\n      object-fit: contain;\n      display: block;\n    }\n\n    /* Navigation Arrows */\n    .nav-btn {\n        position: absolute;\n        top: 50%;\n        transform: translateY(-50%);\n        background: rgba(255, 255, 255, 0.2);\n        border: none;\n        border-radius: 50%;\n        width: 32px;\n        height: 32px;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        color: white;\n        font-size: 18px;\n        backdrop-filter: blur(4px);\n        transition: background 0.3s;\n        z-index: 10;\n    }\n    .nav-btn:hover {\n        background: rgba(255, 255, 255, 0.4);\n    }\n    .nav-prev {\n        left: 10px;\n    }\n    .nav-next {\n        right: 10px;\n    }\n\n    .content {\n      padding: 16px;\n    }\n\n    h1 {\n      font-size: 18px;\n      margin: 0 0 12px;\n      line-height: 1.4;\n    }\n\n    .text {\n      font-size: 14px;\n      line-height: 1.7;\n      white-space: pre-wrap;\n    }\n\n    .tags {\n      margin-top: 12px;\n      color: #999;\n      font-size: 13px;\n    }\n\n    .actions {\n      padding: 16px;\n      display: flex;\n      gap: 12px;\n      border-top: 1px solid #eee;\n    }\n\n    .btn {\n      display: block;\n      flex: 1;\n      padding: 12px;\n      border: none;\n      border-radius: 8px;\n      font-size: 15px;\n      font-weight: 500;\n      cursor: pointer;\n      transition: all 0.3s;\n      text-decoration: none;\n      text-align: center;\n    }\n\n    .btn-confirm {\n      background: #ff2442;\n      color: white;\n    }\n\n    .btn-confirm:hover {\n      background: #e02038;\n    }\n\n    .btn-cancel {\n      background: #f0f0f0;\n      color: #666;\n    }\n\n    .btn-cancel:hover {\n      background: #e0e0e0;\n    }\n\n    .status {\n      padding: 12px;\n      text-align: center;\n      font-size: 13px;\n      color: #666;\n    }\n  </style>\n</head>\n\n<body>\n  <div class=\"card\">\n\n    <div class=\"carousel-wrapper\">\n        <div class=\"images\" id=\"imagesContainer\">\n          ${imagesHtml}\n        </div>\n        <!-- Navigation Arrows -->\n        <button class=\"nav-btn nav-prev\" onclick=\"scrollImages(-1)\">â®</button>\n        <button class=\"nav-btn nav-next\" onclick=\"scrollImages(1)\">â¯</button>\n    </div>\n\n    <div class=\"content\">\n      <h1>${data.title}</h1>\n      <div class=\"text\">${data.content}</div>\n      <div class=\"tags\">${tagsHtml}</div>\n    </div>\n\n    <div class=\"actions\">\n      <button class=\"btn btn-cancel\" onclick=\"handleAction('cancel')\">âŒ å–æ¶ˆå‘å¸ƒ</button>\n      <button class=\"btn btn-confirm\" onclick=\"handleAction('confirm')\">âœ… ç¡®è®¤å‘å¸ƒ</button>\n    </div>\n    <div class=\"status\" id=\"status\">ğŸ‘€ è¯·ç¡®è®¤å†…å®¹æ— è¯¯åç‚¹å‡»æŒ‰é’®</div>\n  </div>\n\n  <script>\n    const serverResumeUrl = \"${n8nResumeUrl}\";\n    let resumeUrl = serverResumeUrl;\n    if (!resumeUrl) {\n        console.warn('Fallback URL used');\n        const isTest = window.location.pathname.includes('/webhook-test/');\n        const urlPrefix = isTest ? '/webhook-test/' : '/webhook/';\n        resumeUrl = window.location.origin + urlPrefix + 'wait-publish-confirm';\n    }\n\n    // Image Carousel Logic\n    function scrollImages(direction) {\n        const container = document.getElementById('imagesContainer');\n        const scrollAmount = container.clientWidth;\n        container.scrollBy({ left: direction * scrollAmount, behavior: 'smooth' });\n    }\n\n    async function handleAction(action) {\n      const status = document.getElementById('status');\n      const buttons = document.querySelectorAll('.btn');\n      buttons.forEach(btn => btn.disabled = true);\n      \n      if (action === 'cancel') {\n        status.textContent = 'âŒ å·²å–æ¶ˆå‘å¸ƒ';\n        status.style.color = '#999';\n        return;\n      }\n      status.textContent = 'â³ æ­£åœ¨å‘å¸ƒ...';\n      status.style.color = '#ff2442';\n      \n      try {\n        // GET request as requested\n        const response = await fetch(resumeUrl + '?action=confirm', {\n          method: 'GET',\n          headers: { 'Accept': 'application/json' }\n        });\n        \n        if (response.ok) {\n          status.textContent = 'âœ… å‘å¸ƒæˆåŠŸï¼çª—å£å°†è‡ªåŠ¨å…³é—­';\n          status.style.color = '#52c41a';\n          setTimeout(() => window.close(), 3000);\n        } else {\n          const text = await response.text().catch(() => '');\n          throw new Error('å‘å¸ƒå¤±è´¥ ' + response.status + ' ' + text);\n        }\n      } catch (error) {\n        console.error(error);\n        status.textContent = 'âŒ å‘å¸ƒå¤±è´¥: ' + error.message;\n        status.style.color = '#f5222d';\n        buttons.forEach(btn => btn.disabled = false);\n      }\n    }\n  </script>\n</body>\n</html>`;\n\nreturn { html };"
      },
      "id": "7c05a651-ca92-4fbd-a280-8509595ff3a4",
      "name": "ç”ŸæˆHTML",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1120,
        16
      ]
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "={{ $json.html }}",
        "options": {
          "responseHeaders": {
            "entries": [
              {
                "name": "Content-Type",
                "value": "text/html"
              }
            ]
          }
        }
      },
      "id": "f9cfaf39-5daf-4303-9e23-f58764ba7bdd",
      "name": "å‘é€é¢„è§ˆåˆ°æµè§ˆå™¨",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        1280,
        144
      ]
    },
    {
      "parameters": {
        "jsCode": "// âš ï¸ ç¡®è®¤å‘å¸ƒæ£€æŸ¥ç‚¹ âš ï¸\n// \n// ğŸ“‹ å‘å¸ƒå‰è¯·ç¡®è®¤ï¼š\n// 1. åœ¨\"HTMLé¢„è§ˆ\"èŠ‚ç‚¹æŸ¥çœ‹ç”Ÿæˆçš„å†…å®¹\n// 2. ç¡®è®¤æ ‡é¢˜ã€æ­£æ–‡ã€æ ‡ç­¾ã€å›¾ç‰‡éƒ½æ­£ç¡®æ— è¯¯\n// 3. ç¡®è®¤åï¼Œæ­¤èŠ‚ç‚¹ä¼šå°†æ­£ç¡®çš„JSONæ•°æ®ä¼ é€’ç»™å‘å¸ƒæµç¨‹\n// \n// ğŸ’¡ æ­¤èŠ‚ç‚¹ä¼šé€ä¼ åŸå§‹æ•°æ®ï¼Œä¸åšä»»ä½•ä¿®æ”¹\n\nconst data = $input.first().json;\n\n// éªŒè¯å¿…éœ€å­—æ®µ\nif (!data.title || !data.content || !data.images || data.images.length === 0) {\n  throw new Error('âŒ æ•°æ®ä¸å®Œæ•´ï¼šç¼ºå°‘å¿…éœ€å­—æ®µï¼ˆtitle/content/imagesï¼‰');\n}\n\n// è¾“å‡ºæ—¥å¿—ä¾›ç¡®è®¤\nconsole.log('ğŸ“‹ å‡†å¤‡å‘å¸ƒçš„å†…å®¹ï¼š');\nconsole.log('æ ‡é¢˜:', data.title);\nconsole.log('æ­£æ–‡é•¿åº¦:', data.content.length, 'å­—');\nconsole.log('æ ‡ç­¾:', data.tags);\nconsole.log('å›¾ç‰‡æ•°é‡:', data.images.length);\n\n// é€ä¼ åŸå§‹æ•°æ®\nreturn [$input.first().json];"
      },
      "id": "2e07b65a-d204-40ab-ad32-d405bfd2c7db",
      "name": "âœ…ç¡®è®¤å‘å¸ƒ",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        864,
        -80
      ]
    },
    {
      "parameters": {
        "resume": "webhook",
        "options": {}
      },
      "id": "ca6fea9b-6a9f-4c09-a6f9-7c65fc3f1027",
      "name": "â³ç­‰å¾…ç”¨æˆ·ç¡®è®¤",
      "type": "n8n-nodes-base.wait",
      "typeVersion": 1.1,
      "position": [
        1456,
        -16
      ],
      "webhookId": "wait-publish-confirm"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "doubao-seed-1-8-251228",
          "mode": "list",
          "cachedResultName": "doubao-seed-1-8-251228"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -784,
        240
      ],
      "id": "d3f1e620-73a8-4c26-bf52-b5c4bfbaf599",
      "name": "ç«å±±-db1.8",
      "credentials": {
        "openAiApi": {
          "id": "3iRvcAcvDVdKLy4T",
          "name": "ç«å±±å¼•æ“-æ–‡æœ¬"
        }
      }
    },
    {
      "parameters": {
        "options": {
          "responseMode": "responseNodes"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chatTrigger",
      "typeVersion": 1.4,
      "position": [
        -1920,
        -176
      ],
      "id": "227b560c-d484-411c-90fb-5cb0464ed74e",
      "name": "When chat message received",
      "webhookId": "ca7d67c3-10ae-47ee-a5b3-645a6e5a503d"
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "doubao-seed-1-8-251228",
          "mode": "list",
          "cachedResultName": "doubao-seed-1-8-251228"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -1264,
        176
      ],
      "id": "27de2d86-1c39-488a-8bf5-93c8032d29e7",
      "name": "ç«å±±-db1-8",
      "credentials": {
        "openAiApi": {
          "id": "3iRvcAcvDVdKLy4T",
          "name": "ç«å±±å¼•æ“-æ–‡æœ¬"
        }
      }
    },
    {
      "parameters": {
        "model": {
          "__rl": true,
          "value": "doubao-seed-1-8-251228",
          "mode": "list",
          "cachedResultName": "doubao-seed-1-8-251228"
        },
        "builtInTools": {},
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenAi",
      "typeVersion": 1.3,
      "position": [
        -400,
        208
      ],
      "id": "9524639c-16fd-42a8-88f2-bfe167ce2066",
      "name": "ç«å±±-db18",
      "credentials": {
        "openAiApi": {
          "id": "3iRvcAcvDVdKLy4T",
          "name": "ç«å±±å¼•æ“-æ–‡æœ¬"
        }
      }
    },
    {
      "parameters": {
        "html": "<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <title>å°çº¢ä¹¦å‘å¸ƒé¢„è§ˆ</title>\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\" />\n\n  <style>\n    body {\n      margin: 0;\n      padding: 20px;\n      background: #f6f6f6;\n      font-family: -apple-system, BlinkMacSystemFont, \"PingFang SC\", Arial;\n    }\n\n    .card {\n      max-width: 420px;\n      margin: 0 auto;\n      background: #fff;\n      border-radius: 14px;\n      overflow: hidden;\n      box-shadow: 0 10px 28px rgba(0,0,0,0.08);\n    }\n\n    .images img {\n      width: 100%;\n      display: block;\n      border-bottom: 1px solid #eee;\n    }\n\n    .content {\n      padding: 16px;\n    }\n\n    h1 {\n      font-size: 18px;\n      margin: 0 0 12px;\n      line-height: 1.4;\n    }\n\n    .text {\n      font-size: 14px;\n      line-height: 1.7;\n      white-space: pre-wrap;\n    }\n\n    .tags {\n      margin-top: 12px;\n      color: #999;\n      font-size: 13px;\n    }\n\n    .status {\n      padding: 12px;\n      background: #fafafa;\n      text-align: center;\n      font-size: 13px;\n      color: #666;\n      border-top: 1px solid #eee;\n    }\n  </style>\n</head>\n\n<body>\n  <div class=\"card\">\n\n    <!-- å›¾ç‰‡å¹³é“ºå±•ç¤º -->\n    <div class=\"images\">\n      {{\n          $json.data\n            .map(img => `\n              <div class=\"slide\">\n                <img src=\"${img.url}\" />\n              </div>\n            `)\n            .join('')\n        }}\n    </div>\n\n  </div>\n</body>\n</html>\n"
      },
      "type": "n8n-nodes-base.html",
      "typeVersion": 1.2,
      "position": [
        336,
        176
      ],
      "id": "5b2dc7cb-e881-4d0f-9f72-19f1bfaf9e31",
      "name": "HTML1"
    },
    {
      "parameters": {
        "httpMethod": "GET",
        "path": "xhs-start",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "form-entry-webhook",
      "name": "è¡¨å•å…¥å£",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [
        -1616,
        -500
      ]
    },
    {
      "parameters": {
        "respondWith": "text",
        "responseBody": "={{ $json.html }}",
        "options": {
          "responseHeaders": {
            "entries": [
              {
                "name": "Content-Type",
                "value": "text/html"
              }
            ]
          }
        }
      },
      "id": "response-form-html",
      "name": "æ˜¾ç¤ºè¾“å…¥è¡¨å•",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        -1392,
        -500
      ]
    },
    {
      "parameters": {
        "jsCode": "// 1. æ„é€  HTML è¡¨å•\n// action æŒ‡å‘å®é™…å¤„ç†çš„ Webhook UUID è·¯å¾„\nconst targetWebhook = 'b0d17f6d-4ee9-4950-8230-b95a936b43cc';\n\nconst html = `\n<!DOCTYPE html>\n<html lang=\"zh-CN\">\n<head>\n  <meta charset=\"UTF-8\">\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n  <title>å°çº¢ä¹¦ç¬”è®°ç”Ÿæˆå™¨</title>\n  <style>\n    body {\n      font-family: -apple-system, BlinkMacSystemFont, \"PingFang SC\", \"Microsoft YaHei\", sans-serif;\n      background-color: #f7f7f7;\n      display: flex;\n      justify-content: center;\n      align-items: center;\n      min-height: 100vh;\n      margin: 0;\n    }\n    .container {\n      background: white;\n      padding: 2rem;\n      border-radius: 16px;\n      box-shadow: 0 4px 20px rgba(0,0,0,0.08);\n      width: 100%;\n      max-width: 500px;\n    }\n    h2 {\n      text-align: center;\n      color: #333;\n      margin-bottom: 1.5rem;\n    }\n    textarea {\n      width: 100%;\n      height: 200px;\n      padding: 1rem;\n      border: 2px solid #eee;\n      border-radius: 12px;\n      font-size: 16px;\n      resize: vertical;\n      outline: none;\n      box-sizing: border-box;\n      transition: border-color 0.3s;\n    }\n    textarea:focus {\n      border-color: #ff2442;\n    }\n    button {\n      width: 100%;\n      padding: 1rem;\n      margin-top: 1.5rem;\n      background-color: #ff2442;\n      color: white;\n      border: none;\n      border-radius: 12px;\n      font-size: 18px;\n      font-weight: bold;\n      cursor: pointer;\n      transition: background-color 0.3s, transform 0.1s;\n    }\n    button:hover {\n      background-color: #e02038;\n    }\n    button:active {\n      transform: scale(0.98);\n    }\n    .tip {\n      margin-top: 1rem;\n      font-size: 0.9rem;\n      color: #888;\n      text-align: center;\n    }\n  </style>\n</head>\n<body>\n  <div class=\"container\">\n    <h2>ğŸ“ å°çº¢ä¹¦ç¬”è®°ç”Ÿæˆ</h2>\n    <form action=\"${targetWebhook}\" method=\"POST\">\n      <textarea name=\"chatInput\" placeholder=\"è¯·è¾“å…¥æ‚¨çš„ä¸»é¢˜ã€è¦æ±‚æˆ–åŸå§‹æ–‡æ¡ˆ...\" required></textarea>\n      <button type=\"submit\">âœ¨ å¼€å§‹ç”Ÿæˆé¢„è§ˆ</button>\n      <p class=\"tip\">ç”Ÿæˆå¯èƒ½éœ€è¦ 15-30 ç§’ï¼Œè¯·è€å¿ƒç­‰å¾…è·³è½¬...</p>\n    </form>\n  </div>\n</body>\n</html>\n`;\n\nreturn { html };"
      },
      "id": "generate-form-html",
      "name": "æ„é€ è¡¨å•HTML",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -1504,
        -500
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "b0d17f6d-4ee9-4950-8230-b95a936b43cc",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "8d4cb800-b4e2-44a8-ad21-94b2816cd8b5",
      "name": "æµè§ˆå™¨é¢„è§ˆå…¥å£",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        -1616,
        -96
      ],
      "webhookId": "b0d17f6d-4ee9-4950-8230-b95a936b43cc"
    }
  ],
  "pinData": {},
  "connections": {
    "è¾“å…¥è§„èŒƒåŒ–": {
      "main": [
        [
          {
            "node": "é€‰é¢˜ç»“æ„ç”Ÿæˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é€‰é¢˜ç»“æ„ç”Ÿæˆ": {
      "main": [
        [
          {
            "node": "JSONè§£æå™¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "JSONè§£æå™¨": {
      "main": [
        [
          {
            "node": "æ­£æ–‡ç”Ÿæˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ­£æ–‡ç”Ÿæˆ": {
      "main": [
        [
          {
            "node": "æ­£æ–‡ç»“æ„æ‹†åˆ†",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ­£æ–‡ç»“æ„æ‹†åˆ†": {
      "main": [
        [
          {
            "node": "é…å›¾Promptç”Ÿæˆ",
            "type": "main",
            "index": 0
          },
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é…å›¾Promptç”Ÿæˆ": {
      "main": [
        [
          {
            "node": "é…å›¾JSONè§£æå™¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "é…å›¾JSONè§£æå™¨": {
      "main": [
        [
          {
            "node": "ç”Ÿæˆå°é¢å›¾",
            "type": "main",
            "index": 0
          },
          {
            "node": "å†…å®¹å›¾ç”Ÿæˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "çŸ©é˜µè´¦å·æ‹†åˆ†": {
      "main": [
        [
          {
            "node": "çŸ©é˜µå·®å¼‚åŒ–æ”¹å†™Agent",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç”Ÿæˆå°é¢å›¾": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "å†…å®¹å›¾ç”Ÿæˆ": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 2
          },
          {
            "node": "HTML1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç«å±±-doubao": {
      "ai_languageModel": [
        [
          {
            "node": "çŸ©é˜µå·®å¼‚åŒ–æ”¹å†™Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "ç»„è£…æ–‡æ¡ˆ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç»„è£…æ–‡æ¡ˆ": {
      "main": [
        [
          {
            "node": "âœ…ç¡®è®¤å‘å¸ƒ",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "âœ…ç¡®è®¤å‘å¸ƒ": {
      "main": [
        [
          {
            "node": "ç”ŸæˆHTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç”ŸæˆHTML": {
      "main": [
        [
          {
            "node": "å‘é€é¢„è§ˆåˆ°æµè§ˆå™¨",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "å‘é€é¢„è§ˆåˆ°æµè§ˆå™¨": {
      "main": [
        [
          {
            "node": "â³ç­‰å¾…ç”¨æˆ·ç¡®è®¤",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "â³ç­‰å¾…ç”¨æˆ·ç¡®è®¤": {
      "main": [
        [
          {
            "node": "Upsert row(s)",
            "type": "main",
            "index": 0
          },
          {
            "node": "xhs_mcp",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "ç«å±±-db1.8": {
      "ai_languageModel": [
        [
          {
            "node": "æ­£æ–‡ç”Ÿæˆ",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "When chat message received": {
      "main": [
        []
      ]
    },
    "ç«å±±-db1-8": {
      "ai_languageModel": [
        [
          {
            "node": "é€‰é¢˜ç»“æ„ç”Ÿæˆ",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "ç«å±±-db18": {
      "ai_languageModel": [
        [
          {
            "node": "é…å›¾Promptç”Ÿæˆ",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "æµè§ˆå™¨é¢„è§ˆå…¥å£": {
      "main": [
        [
          {
            "node": "è¾“å…¥è§„èŒƒåŒ–",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "è¡¨å•å…¥å£": {
      "main": [
        [
          {
            "node": "æ„é€ è¡¨å•HTML",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "æ„é€ è¡¨å•HTML": {
      "main": [
        [
          {
            "node": "æ˜¾ç¤ºè¾“å…¥è¡¨å•",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false,
    "timeSavedMode": "fixed",
    "callerPolicy": "workflowsFromSameOwner"
  },
  "versionId": "b3415c3c-0492-4236-91fe-802272d3be68",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "24d1029a95c23bce7943e6b7ccf730ff90a74df4094f4f597034760d7c386159"
  },
  "id": "xsLYJlYQwt9ddFxM8IC_I",
  "tags": []
}